"use strict";(self.webpackChunkl_admin_react=self.webpackChunkl_admin_react||[]).push([[1091,82138],{3355:function(e,n,t){t.d(n,{Z:function(){return s}});t(47313);var r=t(52917),a=t(20377);var i=t(46417),s=function(e){var n=e.title,t=e.subTitle,s=e.extra,c=e.children,u=e.onBack,o={wrap:(0,a.l)((function(){return{height:"100%",display:"flex",flexDirection:"column",color:"#000000d9",fontSize:"14px",position:"relative",padding:"16px 24px",backgroundColor:"#fff"}})),head:(0,a.l)((function(){return{display:"flex",justifyContent:"space-between"}})),headLeft:(0,a.l)((function(){return{display:"flex",alignItems:"center",margin:"4px 0",overflow:"hidden"}})),headBack:(0,a.l)((function(){return{marginRight:"16px",fontSize:"16px",lineHeight:1}})),headBackButton:(0,a.l)((function(e){return{display:"inline-block",transition:"color .3s",color:e.token.colorPrimary,cursor:"pointer"}})),headTitle:(0,a.l)((function(){return{marginRight:"12px",color:"#000000d9",fontWeight:600,fontSize:"20px",lineHeight:"32px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}})),headSubTitle:(0,a.l)((function(){return{marginRight:"12px",color:"#00000073",fontSize:"14px",lineHeight:"1.5715",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}})),headExtra:(0,a.l)((function(){return{margin:"4px 0",whiteSpace:"nowrap","&>*":{marginLeft:"12px",whiteSpace:"unset"},"&>*:first-child":{marginLeft:0}}})),content:(0,a.l)((function(){return{flex:1,paddingTop:"12px",overflowX:"hidden",overflowY:"auto"}}))};return(0,i.jsxs)("div",{className:o.wrap,children:[(0,i.jsxs)("div",{className:o.head,children:[(0,i.jsxs)("div",{className:o.headLeft,children:[(0,i.jsx)("div",{className:o.headBack,children:(0,i.jsx)("div",{className:o.headBackButton,onClick:u,children:(0,i.jsx)(r.default,{})})}),(0,i.jsx)("span",{className:o.headTitle,children:n}),(0,i.jsx)("span",{className:o.headSubTitle,children:t})]}),(0,i.jsx)("div",{className:o.headExtra,children:s})]}),(0,i.jsx)("div",{className:o.content,children:c})]})}},62202:function(e,n,t){t.d(n,{y:function(){return r}});var r=Symbol("productEditDone")},31876:function(e,n,t){t.d(n,{Z:function(){return s}});var r=t(15671),a=t(43144),i=function(){function e(){(0,r.Z)(this,e),this.store=void 0,this.store=new Map}return(0,a.Z)(e,[{key:"on",value:function(e,n,t){var r={handler:n,once:!!t};if(this.store.has(e)){var a=this.store.get(e);null===a||void 0===a||a.push(r)}else this.store.set(e,[r])}},{key:"off",value:function(e,n){if(this.store.has(e)){var t=this.store.get(e),r=null===t||void 0===t?void 0:t.findIndex((function(e){return e.handler===n}));(r||0===r)&&(null===t||void 0===t||t.splice(r,1))}}},{key:"emit",value:function(e){for(var n=this,t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];if(this.store.has(e)){var i=this.store.get(e);null===i||void 0===i||i.forEach((function(t){t.handler.apply(t,r),t.once&&n.off(e,t.handler)}))}}},{key:"once",value:function(e,n){this.on(e,n,!0)}}]),e}(),s=new i},27690:function(e,n,t){t.d(n,{N:function(){return u}});var r=t(74165),a=t(15861),i=t(55611),s=t(84312),c=t(32335),u=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(n,t){var a,u,o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.Z.get(s.gh,{params:{ext:n.name.slice(n.name.lastIndexOf("."))}});case 2:return a=e.sent,u=a.data,o=new FormData,Object.keys(u).forEach((function(e){var n=u[e];o.append(e,n)})),o.append("file",n),e.next=9,i.Z.post(c.Z.http.uploadURL,o,{onUploadProgress:function(e){if(e.total){var n=Math.round(100*e.loaded/e.total);t&&t(n)}}});case 9:return e.abrupt("return","".concat(c.Z.http.downloadURL,"/").concat(u.key));case 10:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}()},86081:function(e,n,t){t.d(n,{Bo:function(){return s},D$:function(){return u},RC:function(){return c},jS:function(){return i}});var r=t(55611),a=t(84312),i=function(e){return r.Z.get(a.ut,{params:{id:e}})},s=function(e){return r.Z.post(a.yZ,e)},c=function(e){return r.Z.delete(a.yg,{data:{ids:e}})},u=function(e){return r.Z.post(a.jN,e)}},20377:function(e,n,t){t.d(n,{l:function(){return i}});var r=t(838),a=t(92465),i=function(e){var n=a.Z.useToken();return(0,r.iv)(e(n))}},14820:function(e,n,t){t.r(n);var r=t(74165),a=t(1413),i=t(93433),s=t(15861),c=t(29439),u=t(47313),o=t(79930),l=t(59491),d=t(99613),f=t(68197),h=t(59624),p=t(40440),x=t(49375),v=t(32697),Z=t(92594),m=t(58467),g=t(3355),j=t(75590),w=t(86081),b=t(31876),k=t(62202),y=t(37413),S=t(82138),q=t(27690),I=t(46417);n.default=function(){var e=(0,m.UO)(),n=(0,m.s0)(),t=(0,j.$G)().t,N=o.Z.useForm(),B=(0,c.Z)(N,1)[0],R=(0,u.useState)(!1),C=(0,c.Z)(R,2),E=C[0],T=C[1],L=(0,u.useState)(!1),z=(0,c.Z)(L,2),M=z[0],P=z[1],O=(0,u.useState)([]),U=(0,c.Z)(O,2),_=U[0],D=U[1],F=(0,u.useMemo)((function(){return e.id?t("edit"):t("add")}),[e.id,t]),H=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(n){var t,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={uid:n.file.uid,name:"",status:"uploading",url:""},D((function(e){return[].concat((0,i.Z)(e),[t])})),e.prev=2,e.next=5,(0,q.N)(n.file,(function(e){n.onProgress&&n.onProgress({percent:e})}));case 5:s=e.sent,n.onSuccess&&n.onSuccess(s),D((function(e){var n=e.findIndex((function(e){return e.uid===t.uid}));return n>-1&&e.splice(n,1,(0,a.Z)((0,a.Z)({},t),{},{status:"success",url:s})),(0,i.Z)(e)})),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),D((function(e){var n=e.findIndex((function(e){return e.uid===t.uid}));return n>-1&&e.splice(n,1,(0,a.Z)((0,a.Z)({},t),{},{status:"error"})),(0,i.Z)(e)}));case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(n){return e.apply(this,arguments)}}(),A=function(){var i=(0,s.Z)((0,r.Z)().mark((function i(){var s,c;return(0,r.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,B.validateFields();case 3:return s=r.sent,P(!0),c=[],_.forEach((function(e){"success"===e.status&&c.push(e.url)})),r.next=9,(0,w.Bo)(e.id?(0,a.Z)((0,a.Z)({},s),{},{_id:e.id,images:c}):(0,a.Z)((0,a.Z)({},s),{},{images:c}));case 9:b.Z.emit(k.y),P(!1),y.yw.success(t("whatSuccess",{what:t("save")})),n(-1),r.next=18;break;case 15:r.prev=15,r.t0=r.catch(0),P(!1);case 18:case"end":return r.stop()}}),i,null,[[0,15]])})));return function(){return i.apply(this,arguments)}}(),V=(0,u.useCallback)((0,s.Z)((0,r.Z)().mark((function n(){var t;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.id){n.next=14;break}return T(!0),n.prev=2,n.next=5,(0,w.jS)(e.id);case 5:t=n.sent,D(t.data.images.map((function(e,n){return{uid:"".concat(n),name:"",url:e,status:"success"}}))),B.setFieldsValue(t.data),T(!1),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(2),T(!1);case 14:case"end":return n.stop()}}),n,null,[[2,11]])}))),[e.id,B]);return(0,u.useEffect)((function(){V()}),[V]),(0,I.jsx)(g.Z,{title:F,onBack:function(){return n(-1)},extra:(0,I.jsx)(l.ZP,{type:"primary",onClick:A,loading:M,children:t("save")}),children:(0,I.jsx)(d.Z,{loading:E,active:!0,children:(0,I.jsx)(o.Z,{form:B,children:(0,I.jsxs)(f.Z,{gutter:24,children:[(0,I.jsx)(h.Z,{span:8,children:(0,I.jsx)(o.Z.Item,{name:"name",label:"\u540d\u79f0",rules:[{required:!0}],children:(0,I.jsx)(p.Z,{})})}),(0,I.jsx)(h.Z,{span:8,children:(0,I.jsx)(o.Z.Item,{name:"brand",label:"\u54c1\u724c",rules:[{required:!0}],children:(0,I.jsx)(p.Z,{})})}),(0,I.jsx)(h.Z,{span:8,children:(0,I.jsx)(o.Z.Item,{name:"category",label:"\u5206\u7c7b",rules:[{required:!0}],children:(0,I.jsx)(p.Z,{})})}),(0,I.jsx)(h.Z,{span:8,children:(0,I.jsx)(o.Z.Item,{name:"price",label:"\u4ef7\u683c",rules:[{required:!0}],children:(0,I.jsx)(x.Z,{style:{width:"100%"},min:0,precision:2})})}),(0,I.jsx)(h.Z,{span:8,children:(0,I.jsx)(o.Z.Item,{name:"color",label:"\u989c\u8272",rules:[{required:!0}],children:(0,I.jsx)(p.Z,{})})}),(0,I.jsx)(h.Z,{span:8,children:(0,I.jsx)(o.Z.Item,{name:"inventory",label:"\u5e93\u5b58",rules:[{required:!0}],children:(0,I.jsx)(x.Z,{style:{width:"100%"},min:0,precision:0})})}),(0,I.jsx)(h.Z,{span:8,children:(0,I.jsx)(o.Z.Item,{name:"style",label:"\u6837\u5f0f",rules:[{required:!0}],children:(0,I.jsx)(p.Z,{})})}),(0,I.jsx)(h.Z,{span:8,children:(0,I.jsx)(o.Z.Item,{name:"enable",label:"\u662f\u5426\u542f\u7528",valuePropName:"checked",children:(0,I.jsx)(v.Z,{})})}),(0,I.jsx)(h.Z,{span:24,children:(0,I.jsx)(o.Z.Item,{name:"describe",label:"\u63cf\u8ff0",children:(0,I.jsx)(p.Z.TextArea,{})})}),(0,I.jsx)(h.Z,{span:24,children:(0,I.jsx)(o.Z.Item,{name:"images",label:"\u56fe\u7247",children:(0,I.jsx)(Z.Z,{accept:"image/*",listType:"picture-card",multiple:!0,fileList:_,customRequest:H,maxCount:5,beforeUpload:function(e,n){var t=_.length;return n.slice(0,5-t).some((function(n){return n.uid===e.uid}))},onRemove:function(e){D(_.filter((function(n){return n.uid!==e.uid})))},children:_.length<5?(0,I.jsx)(S.default,{}):null})})})]})})})})}},67440:function(e,n,t){t.r(n),t.d(n,{default:function(){return u}});var r=t(87462),a=t(47313),i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"}}]},name:"down",theme:"outlined"},s=t(17469),c=function(e,n){return a.createElement(s.Z,(0,r.Z)({},e,{ref:n,icon:i}))};var u=a.forwardRef(c)},82138:function(e,n,t){t.r(n),t.d(n,{default:function(){return u}});var r=t(87462),a=t(47313),i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8z"}},{tag:"path",attrs:{d:"M176 474h672q8 0 8 8v60q0 8-8 8H176q-8 0-8-8v-60q0-8 8-8z"}}]},name:"plus",theme:"outlined"},s=t(17469),c=function(e,n){return a.createElement(s.Z,(0,r.Z)({},e,{ref:n,icon:i}))};var u=a.forwardRef(c)}}]);